import{i as f,s as c,a as i,h as v,b as y}from"./app-CWWncusU.js";import{c as C,e as S}from"./indexedService-CyxUA599.js";import{n as d}from"./navigate-CzB6ZO3P.js";const m=document.getElementById("sign-up-form"),E=new URLSearchParams(window.location.search),p=E.get("id"),g=p||"";let o=null;async function T(){if(g===""){c("Error loading event. Please try again.","main-message","error"),d("/events");return}try{o=await C(parseInt(g))}catch(e){c(e,"main-message","error"),d("/events");return}if(o===null){i("Could not find event","main-message","error"),m.remove();let e=document.createElement("section");e.setAttribute("class","card");let t=document.createElement("h2"),a=document.createTextNode("Could not find event");t.appendChild(a),e.appendChild(t);let n=document.createElement("p"),s=document.createTextNode("The event you were looking for does not exist or the url is incorrect. Please go back to the events page and try again.");n.appendChild(s),e.appendChild(n);let r=document.querySelector("main");r&&r.appendChild(e)}else{const e=document.getElementById("sign-up-header"),t=document.createElement("h2"),a=document.createTextNode(`Sign up for ${o.eventTitle}`);t.appendChild(a),e.appendChild(t);const n=document.createElement("h3"),s=document.createTextNode(`${v(o.eventDate,"longDate")} ${o.eventTime}`);n.appendChild(s),e.appendChild(n);const r=document.createElement("h3"),l=document.createTextNode(o.eventLocation);r.appendChild(l),e.appendChild(r);const u=document.getElementById("loading");u&&u.remove(),m.classList.remove("hide")}async function h(){i("Submitting entry data...","main-message","info");const e=new FormData(m);let t={eventId:+g,fullName:"",email:""};const a=e.get("fullName");if(a===null||a.toString().trim()===""){i("Please enter your name","main-message","error");return}else if(a.toString().split(" ").length<2){i("Please enter your first and last name","main-message","error");return}else t.fullName=y(a.toString());const n=e.get("email");if(n===null||n.toString().trim()===""){i("Please enter your email","main-message","error");return}if(n.toString().split("@").length<2){i("Please enter a valid email","main-message","error");return}else t.email=n.toString();const r=e.get("comments");r&&(t.comments=r.toString());try{await S(t),c(`You have sucessfully signed up for the event '${o.eventTitle}'`,"main-message","check_circle"),d("/events")}catch(l){i(l,"main-message","error")}}m.addEventListener("submit",e=>{e.preventDefault(),h()})}f("Upcoming Events","Event Sign Up").then(()=>{T()});
