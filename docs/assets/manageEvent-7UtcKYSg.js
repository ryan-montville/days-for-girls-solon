import{i as N,s as E,v as S,b as l,D as A,l as b,e as m,E as P,n as L,h as x,o as F,t as H,T as D,F as M,k as R,G as U}from"./app-BBWCMP6O.js";const h=document.getElementById("sign-up-entires-card"),C=document.getElementById("deleteEventCard"),$=document.getElementById("delete-button"),I=document.getElementById("edit-event-backdrop"),v=document.getElementById("edit-event-modal"),c=document.getElementById("event-info"),V=new URLSearchParams(window.location.search),B=V.get("id"),u=B||"";let s=null;function y(e){c.innerHTML="";const t=document.createElement("h2"),r=document.createTextNode(e.eventTitle);t.appendChild(r),c.appendChild(t);const a=document.createElement("h3"),n=document.createTextNode(`${L(e.eventDate,"longDate")} ${e.eventTime}`);a.appendChild(n),c.appendChild(a);const o=document.createElement("h3"),i=document.createTextNode(e.eventLocation);o.appendChild(i),c.appendChild(o);const d=document.createElement("h3"),p=document.createTextNode(`Number Attending: ${e.numberAttending}`);d.appendChild(p),c.appendChild(d);const g=document.createElement("p"),k=document.createTextNode(e.eventDescription);g.appendChild(k),c.appendChild(g);const f=document.createElement("section");f.setAttribute("class","form-row");const T=F("Edit Event Info","button","editButton","primary","edit_calendar");T.addEventListener("click",()=>{I.style.display="flex",v.setAttribute("aria-modal","true"),document.getElementById("eventTitle").focus(),H(v,I)}),f.appendChild(T),c.appendChild(f)}function w(e){let t=document.getElementById("eventTitle");t.value=e.eventTitle;let r=document.getElementById("eventDate"),a=e.eventDate.toDate();r.value=a.toISOString().split("T")[0];let n=document.getElementById("eventLocation");n.value=e.eventLocation;let o=document.getElementById("eventTime");o.value=e.eventTime;let i=document.getElementById("eventDescription");i.value=e.eventDescription}async function q(){if(l("Updating event data...","edit-event-modal-message","info"),!s){m("edit-event-backdrop"),l("Cannot update event. Please try reloading the page.","main-message","error");return}let e=new FormData(v),t={eventId:u,eventTitle:"",eventDate:D.fromDate(new Date(0)),eventLocation:"",eventTime:"",eventDescription:"",numberAttending:0},r=e.get("eventTitle");if(r===null||r.toString().trim()===""){l("Please enter the title of the event","edit-event-modal-message","error");return}else t.eventTitle=r.toString();const a=e.get("eventDate");if(a===null||a===""){l("Please enter the date of the event","edit-event-modal-message","error");return}else{const d=new Date(a.toString());t.eventDate=D.fromDate(d)}let n=e.get("eventLocation");if(n===null||n.toString().trim()===""){l("Please enter the location of the event","edit-event-modal-message","error");return}else t.eventLocation=n.toString();let o=e.get("eventTime");if(o===null||o.toString().trim()===""){l("Please enter the time of the event","edit-event-modal-message","error");return}else t.eventTime=o.toString();let i=e.get("eventDescription");if(i===null||i.toString().trim()===""){l("Please enter a description for the event","edit-event-modal-message","error");return}else t.eventDescription=i.toString();try{await M(u,t),m("edit-event-backdrop"),s=t,y(t),l("The event was successfully updated","main-message","check_circle")}catch(d){l(d,"edit-event-modal-message","error")}}function K(e,t){const n=R(e,["fullName","email","comments"],"entryId"),o=n.querySelector("button");return o&&o.addEventListener("click",()=>{const i=b(e,"Are you sure you want to delete this entry?");if(i){const d=i.children[0],p=i.children[1];p&&p.addEventListener("click",async()=>{m("delete-item-backdrop");try{await U(e.entryId),l(`Deleted entry from ${e.fullName}`,"main-message","delete"),n.remove(),t.numberAttending-=1,y(t)}catch(g){l(g,"main-message","error")}}),d&&d.addEventListener("click",()=>{m("delete-item-backdrop")})}}),n}function _(e,t){if(t.length===0){let r=document.createElement("p"),a=document.createTextNode(`No one has signed up for ${e.eventTitle} yet`);r.appendChild(a),h.appendChild(r)}else{const a=x("sign-up-table",["Name","Email","Comments","Delete"]);let n=t.reduce((o,i)=>{const d=K(i,e);return o.appendChild(d),o},document.createElement("tbody"));a.appendChild(n),h.appendChild(a)}}async function z(){if(u===""){E("Error loading event. Please try again.","main-message","error"),window.location.href="events.html";return}try{s=await S(u)}catch(e){E(e,"main-message","error"),window.location.href="events.html";return}if(s===null){l("Could not find event","main-message","error"),v.remove(),h.remove(),C.remove();let e=document.createElement("section");e.setAttribute("class","card");let t=document.createElement("h2"),r=document.createTextNode("Could not find event");t.appendChild(r),e.appendChild(t);let a=document.createElement("p"),n=document.createTextNode("The event you were looking for does not exist or the url is incorrect. Please go back to the events page and try again.");a.appendChild(n),e.appendChild(a);let o=document.querySelector("main");o&&o.appendChild(e)}else{w(s);const e=await A(u);_(s,e),y(s);const t=document.getElementById("loading");t&&t.remove(),c.classList.remove("hide"),h.classList.remove("hide"),C.classList.remove("hide"),$.addEventListener("click",()=>{const n=b(s,"Are you sure you want to delete this event?");if(n){const o=n.children[0],i=n.children[1];i&&i.addEventListener("click",async()=>{m("delete-item-backdrop");try{await P(u),E(`Deleted event ${s.eventTitle} ${L(s.eventDate,"shortDate")}`,"main-message","delete"),window.location.href="events.html"}catch(d){l(d,"main-message","error")}}),o&&o.addEventListener("click",()=>{m("delete-item-backdrop")})}}),document.getElementById("reset").addEventListener("click",n=>{n.preventDefault(),w(s)}),document.getElementById("cancel").addEventListener("click",()=>{m("edit-event-backdrop")}),v.addEventListener("submit",n=>{n.preventDefault(),q()})}}N("Upcoming Events").then(()=>{z()});
