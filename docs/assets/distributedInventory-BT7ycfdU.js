import{i as D,c as h,p as f,t as T,b as c,T as y,g as E,a as s,C as I,d as B,e as k,f as C,h as q,j as w,k as L,l as S,m as M}from"./app-Bv0Cmu6z.js";const m=document.getElementById("distribute-inventory-modal"),p=document.getElementById("distribute-inventory-backdrop"),u=document.getElementById("previous-entries-card");function b(e){const i=w(e,["entryDate","componentType","quantity","destination"],"entryId",5,"shortDate"),r=i.querySelector("button");return r&&r.addEventListener("click",()=>{const o=L(e,"Are you sure you want to delete this entry?");if(o){const a=o.children[0],n=o.children[1];n&&n.addEventListener("click",()=>{S(e.entryId),c("delete-item-backdrop"),s(`Deleted entry ${M(e.entryDate.toString(),"shortDate")}: ${e.quantity} ${e.componentType} to ${e.destination}`,"main-message","delete"),i.remove()}),a&&a.addEventListener("click",()=>{c("delete-item-backdrop")})}}),i}function g(){const e=k(),t=u.querySelector("p");t&&t.remove();const d=document.getElementById("previous-entries-table");d&&d.remove();const i=C();if(u.appendChild(i),e.length===0){let r=document.createElement("p"),o=document.createTextNode("No previous entries");r.appendChild(o),i.remove(),u.appendChild(r)}else{const o=q("previous-entries-table",["Date","Component","Quantity","Destination","Delete"]);let a=e.reduceRight((n,l)=>{const v=b(l);return n.appendChild(v),n},document.createElement("tbody"));a.setAttribute("id","distributedTableBody"),o.appendChild(a),i.remove(),u.appendChild(o)}}function P(){const e=new FormData(m);let t={entryId:0,entryDate:y.fromDate(new Date(0)),componentType:"",quantity:0,destination:""};t.entryId=E();const d=e.get("date");if(d===null||d===""){s("Please enter the date the components are leaving","distribute-modal-message","error");return}else{const n=new Date(d.toString());t.entryDate=y.fromDate(n)}const i=e.get("componentType");if(i===null||i.toString().trim()===""){s("Please select what component you are distributing","distribute-modal-message","error");return}else t.componentType=i.toString();const r=e.get("quantity");if(r===null){s("Please enter the quantity of the components being distributed","distribute-modal-message","error");return}else{const n=+r,l=I(t.componentType,n);if(n<1){s("Please enter a quantity greater that 0","distribute-modal-message","error");return}else if(l.hasEnough)t.quantity=n;else{s(`Error: There are only ${l.quantity} ${t.componentType} currently in inventory`,"distribute-modal-message","error");return}}const o=e.get("destination");if(o===null||o.toString().trim()===""){s("Please enter the destination","distribute-modal-message","error");return}else t.destination=o.toString();B(t),c("distribute-inventory-backdrop"),s("The inventory has successfully been updated","main-message","check_circle");const a=document.getElementById("distributedTableBody");if(a){const n=b(t);a.prepend(n)}else g()}D("Inventory");m.addEventListener("submit",e=>{e.preventDefault(),h(),P()});const R=document.getElementById("open-distribute-modal-button");R.addEventListener("click",()=>{f("componentType"),p.style.display="flex",m.setAttribute("aria-modal","true"),document.getElementById("date").focus(),T(m,p)});const N=document.getElementById("cancel");N.addEventListener("click",()=>c("distribute-inventory-backdrop"));g();
