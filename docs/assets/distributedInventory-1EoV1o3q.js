import{i as v,c as h,p as f,t as D,d as c,e as E,a,C as I,f as T,h as B,j as k,k as C,l as q,m as w,n as L,o as S}from"./app-XWpTsKPJ.js";const m=document.getElementById("distribute-inventory-modal"),p=document.getElementById("distribute-inventory-backdrop"),u=document.getElementById("previous-entries-card");function y(e){const t=q(e,5,"distributedEntry","shortDate"),i=t.querySelector("button");return i&&i.addEventListener("click",()=>{const n=w(e,"Are you sure you want to delete this entry?");if(n){const r=n.children[0],o=n.children[1];o&&o.addEventListener("click",()=>{L(e.entryId),c("delete-item-backdrop"),a(`Deleted entry ${S(e.entryDate.toString(),"shortDate")}: ${e.quantity} ${e.componentType} to ${e.destination}`,"main-message","delete"),t.remove()}),r&&r.addEventListener("click",()=>{c("delete-item-backdrop")})}}),t}function b(){const e=B(),t=u.querySelector("p");t&&t.remove();const i=document.getElementById("previous-entries-table");i&&i.remove();const n=k();if(u.appendChild(n),e.length===0){let r=document.createElement("p"),o=document.createTextNode("No previous entries");r.appendChild(o),n.remove(),u.appendChild(r)}else{const o=C("previous-entries-table",["Date","Component","Quantity","Destination","Delete"]);let d=e.reduceRight((s,l)=>{const g=y(l);return s.appendChild(g),s},document.createElement("tbody"));d.setAttribute("id","distributedTableBody"),o.appendChild(d),n.remove(),u.appendChild(o)}}function M(){const e=new FormData(m);let t={entryId:0,entryDate:new Date,componentType:"",quantity:0,destination:""};t.entryId=E();const i=e.get("date");if(i===null||i===""){a("Please enter the date the components are leaving","distribute-modal-message","error");return}else t.entryDate=new Date(i.toString());const n=e.get("componentType");if(n===null||n.toString().trim()===""){a("Please select what component you are distributing","distribute-modal-message","error");return}else t.componentType=n.toString();const r=e.get("quantity");if(r===null){a("Please enter the quantity of the components being distributed","distribute-modal-message","error");return}else{const s=+r,l=I(t.componentType,s);if(s<1){a("Please enter a quantity greater that 0","distribute-modal-message","error");return}else if(l.hasEnough)t.quantity=s;else{a(`Error: There are only ${l.quantity} ${t.componentType} currently in inventory`,"distribute-modal-message","error");return}}const o=e.get("destination");if(o===null||o.toString().trim()===""){a("Please enter the destination","distribute-modal-message","error");return}else t.destination=o.toString();T(t),c("distribute-inventory-backdrop"),a("The inventory has successfully been updated","main-message","check_circle");const d=document.getElementById("distributedTableBody");if(d){const s=y(t);d.prepend(s)}else b()}v("Inventory");m.addEventListener("submit",e=>{e.preventDefault(),h(),M()});const P=document.getElementById("open-distribute-modal-button");P.addEventListener("click",()=>{f("componentType"),p.style.display="flex",m.setAttribute("aria-modal","true"),document.getElementById("date").focus(),D(m,p)});const R=document.getElementById("cancel");R.addEventListener("click",()=>c("distribute-inventory-backdrop"));b();
