import{a as d,i as C,k as L,b as m,s as w,m as k,z as b,t as S,T as f}from"./app-CMNtohD9.js";import{b as A,d as P,u as x}from"./firebaseService-C3nclkl3.js";const M=document.getElementById("sign-up-entires-card"),N=document.getElementById("deleteEventCard"),F=document.getElementById("delete-button"),H=new URLSearchParams(window.location.search),E=H.get("id"),u=E||"";let r=null;r=await A(u);r===null&&d("Could not find event","main-message","error");const T=document.getElementById("edit-event-backdrop"),s=document.getElementById("edit-event-modal");function y(e){const t=document.getElementById("event-info");t.innerHTML="";const n=document.createElement("h2"),o=document.createTextNode(e.eventTitle);n.appendChild(o),t.appendChild(n);const a=document.createElement("h3"),i=document.createTextNode(`${k(e.eventDate,"longDate")} ${e.eventTime}`);a.appendChild(i),t.appendChild(a);const l=document.createElement("h3"),v=document.createTextNode(e.eventLocation);l.appendChild(v),t.appendChild(l);const c=document.createElement("h3"),I=document.createTextNode(`Number Attending: ${e.numberAttending}`);c.appendChild(I),t.appendChild(c);const g=document.createElement("p"),B=document.createTextNode(e.eventDescription);g.appendChild(B),t.appendChild(g);const p=document.createElement("section");p.setAttribute("class","form-row");const h=b("Edit Event Info","button","editButton","primary","edit_calendar");h.addEventListener("click",()=>{T.style.display="flex",s.setAttribute("aria-modal","true"),document.getElementById("eventTitle").focus(),S(s,T)}),p.appendChild(h),t.appendChild(p)}function D(e){let t=document.getElementById("eventTitle");t.value=e.eventTitle;let n=document.getElementById("eventDate"),o=e.eventDate.toDate();n.value=o.toISOString().split("T")[0];let a=document.getElementById("eventLocation");a.value=e.eventLocation;let i=document.getElementById("eventTime");i.value=e.eventTime;let l=document.getElementById("eventDescription");l.value=e.eventDescription}async function U(){let e=new FormData(s),t={eventId:u,eventTitle:"",eventDate:f.fromDate(new Date(0)),eventLocation:"",eventTime:"",eventDescription:"",numberAttending:0},n=e.get("eventTitle");if(n===null||n.toString().trim()===""){d("Please enter the title of the event","edit-event-modal-message","error");return}else t.eventTitle=n.toString();const o=e.get("eventDate");if(o===null||o===""){d("Please enter the date of the event","edit-event-modal-message","error");return}else{const c=new Date(o.toString());t.eventDate=f.fromDate(c)}let a=e.get("eventLocation");if(a===null||a.toString().trim()===""){d("Please enter the location of the event","edit-event-modal-message","error");return}else t.eventLocation=a.toString();let i=e.get("eventTime");if(i===null||i.toString().trim()===""){d("Please enter the time of the event","edit-event-modal-message","error");return}else t.eventTime=i.toString();let l=e.get("eventDescription");if(l===null||l.toString().trim()===""){d("Please enter a description for the event","edit-event-modal-message","error");return}else t.eventDescription=l.toString();const v=await x(u,t);m("edit-event-backdrop"),v?(y(t),d("The event was successfully updated","main-message","check_circle")):d("Unable to update the event. Please reload the page and try again.","main-message","error")}C("Upcoming Events").then(()=>{if(r===null){d("Could not find event","main-message","error"),s.remove(),M.remove(),N.remove();let e=document.createElement("section");e.setAttribute("class","card");let t=document.createElement("h2"),n=document.createTextNode("Could not find event");t.appendChild(n),e.appendChild(t);let o=document.createElement("p"),a=document.createTextNode("The event you were looking for does not exist or the url is incorrect. Please go back to the events page and try again.");o.appendChild(a),e.appendChild(o);let i=document.querySelector("main");i&&i.appendChild(e)}else D(r),y(r),F.addEventListener("click",()=>{const n=L(r,"Are you sure you want to delete this event?");if(n){const o=n.children[0],a=n.children[1];a&&a.addEventListener("click",async()=>{const i=await P(u);m("delete-item-backdrop"),i?(w(`Deleted event ${r.eventTitle} ${r.eventDate}`,"main-message","delete"),window.location.href="events.html"):d("Unable to delete event. Please reload the page and try agian.","main-message","error")}),o&&o.addEventListener("click",()=>{m("delete-item-backdrop")})}}),document.getElementById("reset").addEventListener("click",n=>{n.preventDefault(),D(r)}),document.getElementById("cancel").addEventListener("click",()=>{m("edit-event-backdrop")}),s.addEventListener("submit",n=>{n.preventDefault(),U()})});
