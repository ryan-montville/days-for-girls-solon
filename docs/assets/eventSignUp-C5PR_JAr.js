import{i as h,s as d,a as i,m as f,c as v}from"./app-DsQYzg7S.js";import{g as y,b as C,u as w}from"./firebaseService-C42aOLZT.js";const c=document.getElementById("sign-up-form"),E=new URLSearchParams(window.location.search),g=E.get("id"),m=g||"";let o=null;async function S(){if(m===""){d("Error loading event. Please try again.","main-message","error"),window.location.href="events.html";return}try{o=await y(m)}catch{d("Error loading event. Please try again.","main-message","error"),window.location.href="events.html";return}if(o===null){i("Could not find event","main-message","error"),c.remove();let e=document.createElement("section");e.setAttribute("class","card");let t=document.createElement("h2"),a=document.createTextNode("Could not find event");t.appendChild(a),e.appendChild(t);let n=document.createElement("p"),s=document.createTextNode("The event you were looking for does not exist or the url is incorrect. Please go back to the events page and try again.");n.appendChild(s),e.appendChild(n);let r=document.querySelector("main");r&&r.appendChild(e)}else{const e=document.getElementById("sign-up-header"),t=document.createElement("h2"),a=document.createTextNode(`Sign up for ${o.eventTitle}`);t.appendChild(a),e.appendChild(t);const n=document.createElement("h3"),s=document.createTextNode(`${f(o.eventDate,"longDate")} ${o.eventTime}`);n.appendChild(s),e.appendChild(n);const r=document.createElement("h3"),l=document.createTextNode(o.eventLocation);r.appendChild(l),e.appendChild(r);const u=document.getElementById("loading");u&&u.remove(),c.classList.remove("hide")}async function p(){const e=new FormData(c);let t={entryId:"",eventId:m,fullName:"",email:""};const a=e.get("fullName");if(a===null||a.toString().trim()===""){i("Please enter your name","main-message","error");return}else if(a.toString().split(" ").length<2){i("Please enter your first and last name","main-message","error");return}else t.fullName=a.toString();const n=e.get("email");if(n===null||n.toString().trim()===""){i("Please enter your email","main-message","error");return}if(n.toString().split("@").length<2){i("Please enter a valid email","main-message","error");return}else t.email=n.toString();const r=e.get("comments");r&&(t.comments=r.toString());try{await C(t),await w(m,!0)?console.log("Increased number attending"):console.error("Could not update num attending"),d(`You have sucessfully signed up for the event '${o.eventTitle}'`,"main-message","check_circle"),window.location.href="events.html"}catch{i("Failed to sign up for event. Please try again","main-message","error")}}c.addEventListener("submit",e=>{e.preventDefault(),v(),p()})}h("Upcoming Events").then(()=>{S()});
