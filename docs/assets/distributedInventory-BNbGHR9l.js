import{i as h,b as f,p as D,t as E,f as c,T as p,h as I,e as a,C as T,j as B,k,l as C,m as q,n as w,o as L,q as S,r as M}from"./app-BOYs2vfY.js";const m=document.getElementById("distribute-inventory-modal"),y=document.getElementById("distribute-inventory-backdrop"),u=document.getElementById("previous-entries-card");function b(e){const t=w(e,5,"distributedEntry","shortDate"),i=t.querySelector("button");return i&&i.addEventListener("click",()=>{const n=L(e,"Are you sure you want to delete this entry?");if(n){const s=n.children[0],o=n.children[1];o&&o.addEventListener("click",()=>{S(e.entryId),c("delete-item-backdrop"),a(`Deleted entry ${M(e.entryDate.toString(),"shortDate")}: ${e.quantity} ${e.componentType} to ${e.destination}`,"main-message","delete"),t.remove()}),s&&s.addEventListener("click",()=>{c("delete-item-backdrop")})}}),t}function g(){const e=k(),t=u.querySelector("p");t&&t.remove();const i=document.getElementById("previous-entries-table");i&&i.remove();const n=C();if(u.appendChild(n),e.length===0){let s=document.createElement("p"),o=document.createTextNode("No previous entries");s.appendChild(o),n.remove(),u.appendChild(s)}else{const o=q("previous-entries-table",["Date","Component","Quantity","Destination","Delete"]);let d=e.reduceRight((r,l)=>{const v=b(l);return r.appendChild(v),r},document.createElement("tbody"));d.setAttribute("id","distributedTableBody"),o.appendChild(d),n.remove(),u.appendChild(o)}}function P(){const e=new FormData(m);let t={entryId:0,entryDate:p.fromDate(new Date(0)),componentType:"",quantity:0,destination:""};t.entryId=I();const i=e.get("date");if(i===null||i===""){a("Please enter the date the components are leaving","distribute-modal-message","error");return}else{const r=new Date(i.toString());t.entryDate=p.fromDate(r)}const n=e.get("componentType");if(n===null||n.toString().trim()===""){a("Please select what component you are distributing","distribute-modal-message","error");return}else t.componentType=n.toString();const s=e.get("quantity");if(s===null){a("Please enter the quantity of the components being distributed","distribute-modal-message","error");return}else{const r=+s,l=T(t.componentType,r);if(r<1){a("Please enter a quantity greater that 0","distribute-modal-message","error");return}else if(l.hasEnough)t.quantity=r;else{a(`Error: There are only ${l.quantity} ${t.componentType} currently in inventory`,"distribute-modal-message","error");return}}const o=e.get("destination");if(o===null||o.toString().trim()===""){a("Please enter the destination","distribute-modal-message","error");return}else t.destination=o.toString();B(t),c("distribute-inventory-backdrop"),a("The inventory has successfully been updated","main-message","check_circle");const d=document.getElementById("distributedTableBody");if(d){const r=b(t);d.prepend(r)}else g()}h("Inventory");m.addEventListener("submit",e=>{e.preventDefault(),f(),P()});const R=document.getElementById("open-distribute-modal-button");R.addEventListener("click",()=>{D("componentType"),y.style.display="flex",m.setAttribute("aria-modal","true"),document.getElementById("date").focus(),E(m,y)});const $=document.getElementById("cancel");$.addEventListener("click",()=>c("distribute-inventory-backdrop"));g();
