import{c as v,i as N,w as g,b as C,t as R,x as E,h as T,a as c,m as u,y as x,z as k,j as A,k as S,A as $,r as q,e as L}from"./app-DsQYzg7S.js";const h=document.getElementById("generateForm"),H=document.getElementById("maincontent"),f=document.getElementById("current-inventory-card"),D=document.getElementById("manage-inventory-backdrop"),y=document.getElementById("manage-inventory-modal");function w(t){const r=A(t,["componentType","quantity"],"componentId",3,"componentItem"),o=r.querySelector("button");return o&&o.addEventListener("click",()=>{const e=S(t,"Are you sure you want to delete this component?");if(e){const s=e.children[0],d=e.children[1];d&&d.addEventListener("click",()=>{$(t.componentId),C("delete-item-backdrop"),c(`Deleted component "${t.componentType}"`,"main-message","delete"),r.remove()}),s&&s.addEventListener("click",()=>{C("delete-item-backdrop")})}}),r}function I(){const t=E();if(t.length===0){const n=document.createElement("p"),a=document.createTextNode("There are not items currently in the inventory.");n.appendChild(a),f.appendChild(n)}else{const a=T("current-inventory-table",["Component","Quantity","Delete"]),r=t.reduce((o,e)=>{const s=w(e);return o.appendChild(s),o},document.createElement("tbody"));r.setAttribute("id","currentInventoryTableBody"),a.appendChild(r),f.appendChild(a)}}function M(t,n){const a=q(),r=L();return a.concat(r).filter(d=>d.entryDate.toDate()>=t&&d.entryDate.toDate()<=n).sort((d,l)=>d.entryDate.toDate().getTime()-l.entryDate.toDate().getTime())}function P(t){return E().reduce((r,o)=>{const e={componentType:o.componentType,quantityDonated:0,quantityDistributed:0};return t.filter(d=>d.componentType===e.componentType).forEach(d=>{d.whoDonated?e.quantityDonated+=d.quantity:e.quantityDistributed+=d.quantity}),r.push(e),r},[])}function F(t){const n=T("summary-table",["Total Donated","Total Distributed"]),a=t.reduce((r,o)=>{let e=document.createElement("tr"),s=document.createElement("td"),d=document.createTextNode(`${o.componentType}: ${o.quantityDonated}`);s.appendChild(d),e.appendChild(s);let l=document.createElement("td"),i=document.createTextNode(`${o.componentType}: ${o.quantityDistributed}`);return l.appendChild(i),e.appendChild(l),r.appendChild(e),r},document.createElement("tbody"));return n.appendChild(a),n}function z(t){const n=T("entries-table",["Date","Entry"]),a=t.reduce((r,o)=>{const e=document.createElement("tr"),s=document.createElement("td"),d=document.createTextNode(u(o.entryDate.toString(),"shortDate"));s.appendChild(d),e.appendChild(s);const l=document.createElement("td");if(o.whoDonated){const i=document.createTextNode(`${o.quantity} ${o.componentType} donated by ${o.whoDonated}`);l.appendChild(i)}else{const i=document.createTextNode(`${o.quantity} ${o.componentType} distributed to ${o.destination}`);l.appendChild(i)}return e.appendChild(l),r.appendChild(e),r},document.createElement("tbody"));return n.appendChild(a),n}function K(){let t=new FormData(h),n=t.get("startDate"),a=t.get("endDate");if(n&&a){if(new Date(n.toString())>new Date(a.toString())){c("Please make sure the end date is a later date than the start date","main-message","error");return}}else if(!n&&!a){c("Please select start and end dates","main-message","error");return}else if(!n&&a){c("Please select a start date","main-message","error");return}else if(n&&!a){c("Please select an end date","main-message","error");return}if(h.style.display="none",n&&a){let r=new Date(n.toString()),o=new Date(a.toString()),e=document.createElement("article");e.setAttribute("class","card");let s=M(r,o);if(s.length===0){let i=document.createElement("h2"),p=document.createTextNode("No results");i.appendChild(p),e.appendChild(i);let m=document.createElement("p"),b=document.createTextNode(`No items where donated or distributed ${u(n.toString(),"shortDate")} to ${u(a.toString(),"shortDate")}`);m.appendChild(b),e.appendChild(m)}else{let i=document.createElement("h2"),p=document.createTextNode(`${u(n.toString(),"shortDate")} to ${u(a.toString(),"shortDate")} Report`);i.appendChild(p),e.appendChild(i);let m=P(s);const b=F(m);e.appendChild(b);const B=z(s);e.appendChild(B)}const d=document.createElement("div");d.setAttribute("class","form-row");const l=g("Generate New Report","button","newReport","primary fulll");l.addEventListener("click",()=>{e.remove(),h.style.display="block"}),d.appendChild(l),e.appendChild(d),H.appendChild(e)}}I();h.addEventListener("submit",t=>{t.preventDefault(),v(),K()});function V(t){const n=t.get("nameInput");if(n===null||n.toString().trim()===""){c("Please enter the name of the new component type","manage-inventory-message","error");return}else{const a={componentId:x(),componentType:n.toString().trim(),quantity:0};k(a),c(`Added '${a.componentType}' to inventory`,"main-message","check_circle"),C("manage-inventory-backdrop");const r=document.getElementById("currentInventoryTableBody");if(r){const o=w(a);r.appendChild(o)}else I()}}N("Inventory");const j=document.getElementById("add-new-type");j.addEventListener("click",()=>{y.innerHTML="";const t=document.createElement("form"),n=document.createElement("h2"),a=document.createTextNode("Add a New Component Type");n.appendChild(a),t.appendChild(n);const r=document.createElement("section");r.setAttribute("class","form-row");const o=document.createElement("label");o.setAttribute("for","nameInput");const e=document.createTextNode("Name of new component type:");o.appendChild(e),r.appendChild(o);const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("id","nameInput"),s.setAttribute("name","nameInput"),r.appendChild(s),t.appendChild(r);const d=document.createElement("section");d.setAttribute("class","form-row");const l=g("Cancel","button","cancelButton","secondary");l.addEventListener("click",()=>{C("manage-inventory-backdrop")}),d.appendChild(l);const i=g("Submit","submt","submitButton","primary");d.appendChild(i),t.appendChild(d),t.addEventListener("submit",p=>{v(),p.preventDefault();const m=new FormData(t);V(m)}),y.appendChild(t),D.style.display="flex",y.classList.add("opening"),y.setAttribute("aria-modal","true"),s.focus(),R(t,D)});
