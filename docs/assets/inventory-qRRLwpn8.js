import{b as v,i as N,v as g,f as C,t as R,H as E,m as f,e as c,r as p,I as x,J as A,n as S,o as k,K as $,A as L,k as q}from"./app-BOYs2vfY.js";const h=document.getElementById("generateForm"),H=document.getElementById("maincontent"),T=document.getElementById("current-inventory-card"),D=document.getElementById("manage-inventory-backdrop"),y=document.getElementById("manage-inventory-modal");function w(t){const e=S(t,3),n=e.querySelector("button");return n&&n.addEventListener("click",()=>{const r=k(t,"Are you sure you want to delete this component?");if(r){const o=r.children[0],a=r.children[1];a&&a.addEventListener("click",()=>{$(t.componentId),C("delete-item-backdrop"),c(`Deleted component "${t.componentType}"`,"main-message","delete"),e.remove()}),o&&o.addEventListener("click",()=>{C("delete-item-backdrop")})}}),e}function I(){const t=E();if(t.length===0){const e=document.createElement("p"),n=document.createTextNode("There are not items currently in the inventory.");e.appendChild(n),T.appendChild(e)}else{const n=f("current-inventory-table",["Component","Quantity","Delete"]),r=t.reduce((o,a)=>{const l=w(a);return o.appendChild(l),o},document.createElement("tbody"));r.setAttribute("id","currentInventoryTableBody"),n.appendChild(r),T.appendChild(n)}}function M(t,e){const n=L(),r=q();return n.concat(r).filter(d=>d.entryDate.toDate()>=t&&d.entryDate.toDate()<=e).sort((d,s)=>d.entryDate.toDate().getTime()-s.entryDate.toDate().getTime())}function P(t){return E().reduce((r,o)=>{const a={componentType:o.componentType,quantityDonated:0,quantityDistributed:0};return t.filter(d=>d.componentType===a.componentType).forEach(d=>{d.whoDonated?a.quantityDonated+=d.quantity:a.quantityDistributed+=d.quantity}),r.push(a),r},[])}function F(t){const e=f("summary-table",["Total Donated","Total Distributed"]),n=t.reduce((r,o)=>{let a=document.createElement("tr"),l=document.createElement("td"),d=document.createTextNode(`${o.componentType}: ${o.quantityDonated}`);l.appendChild(d),a.appendChild(l);let s=document.createElement("td"),i=document.createTextNode(`${o.componentType}: ${o.quantityDistributed}`);return s.appendChild(i),a.appendChild(s),r.appendChild(a),r},document.createElement("tbody"));return e.appendChild(n),e}function V(t){const e=f("entries-table",["Date","Entry"]),n=t.reduce((r,o)=>{const a=document.createElement("tr"),l=document.createElement("td"),d=document.createTextNode(p(o.entryDate.toString(),"shortDate"));l.appendChild(d),a.appendChild(l);const s=document.createElement("td");if(o.whoDonated){const i=document.createTextNode(`${o.quantity} ${o.componentType} donated by ${o.whoDonated}`);s.appendChild(i)}else{const i=document.createTextNode(`${o.quantity} ${o.componentType} distributed to ${o.destination}`);s.appendChild(i)}return a.appendChild(s),r.appendChild(a),r},document.createElement("tbody"));return e.appendChild(n),e}function z(){let t=new FormData(h),e=t.get("startDate"),n=t.get("endDate");if(e&&n){if(new Date(e.toString())>new Date(n.toString())){c("Please make sure the end date is a later date than the start date","main-message","error");return}}else if(!e&&!n){c("Please select start and end dates","main-message","error");return}else if(!e&&n){c("Please select a start date","main-message","error");return}else if(e&&!n){c("Please select an end date","main-message","error");return}if(h.style.display="none",e&&n){let r=new Date(e.toString()),o=new Date(n.toString()),a=document.createElement("article");a.setAttribute("class","card");let l=M(r,o);if(l.length===0){let i=document.createElement("h2"),u=document.createTextNode("No results");i.appendChild(u),a.appendChild(i);let m=document.createElement("p"),b=document.createTextNode(`No items where donated or distributed ${p(e.toString(),"shortDate")} to ${p(n.toString(),"shortDate")}`);m.appendChild(b),a.appendChild(m)}else{let i=document.createElement("h2"),u=document.createTextNode(`${p(e.toString(),"shortDate")} to ${p(n.toString(),"shortDate")} Report`);i.appendChild(u),a.appendChild(i);let m=P(l);const b=F(m);a.appendChild(b);const B=V(l);a.appendChild(B)}const d=document.createElement("div");d.setAttribute("class","form-row");const s=g("Generate New Report","button","newReport","primary fulll");s.addEventListener("click",()=>{a.remove(),h.style.display="block"}),d.appendChild(s),a.appendChild(d),H.appendChild(a)}}I();h.addEventListener("submit",t=>{t.preventDefault(),v(),z()});function G(t){const e=t.get("nameInput");if(e===null||e.toString().trim()===""){c("Please enter the name of the new component type","manage-inventory-message","error");return}else{const n={componentId:x(),componentType:e.toString().trim(),quantity:0};A(n),c(`Added '${n.componentType}' to inventory`,"main-message","check_circle"),C("manage-inventory-backdrop");const r=document.getElementById("currentInventoryTableBody");if(r){const o=w(n);r.appendChild(o)}else I()}}N("Inventory");const J=document.getElementById("add-new-type");J.addEventListener("click",()=>{y.innerHTML="";const t=document.createElement("form"),e=document.createElement("h2"),n=document.createTextNode("Add a New Component Type");e.appendChild(n),t.appendChild(e);const r=document.createElement("section");r.setAttribute("class","form-row");const o=document.createElement("label");o.setAttribute("for","nameInput");const a=document.createTextNode("Name of new component type:");o.appendChild(a),r.appendChild(o);const l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("id","nameInput"),l.setAttribute("name","nameInput"),r.appendChild(l),t.appendChild(r);const d=document.createElement("section");d.setAttribute("class","form-row");const s=g("Cancel","button","cancelButton","secondary");s.addEventListener("click",()=>{C("manage-inventory-backdrop")}),d.appendChild(s);const i=g("Submit","submt","submitButton","primary");d.appendChild(i),t.appendChild(d),t.addEventListener("submit",u=>{v(),u.preventDefault();const m=new FormData(t);G(m)}),y.appendChild(t),D.style.display="flex",y.classList.add("opening"),y.setAttribute("aria-modal","true"),l.focus(),R(t,D)});
