import{i as w,s as g,a as r,k as L,b as u,m as k,z as b,t as P,T as E}from"./app-CMNtohD9.js";import{b as S,d as A,u as x}from"./firebaseService-C3nclkl3.js";const M=document.getElementById("sign-up-entires-card"),N=document.getElementById("deleteEventCard"),F=document.getElementById("delete-button"),T=document.getElementById("edit-event-backdrop"),c=document.getElementById("edit-event-modal"),H=new URLSearchParams(window.location.search),y=H.get("id"),s=y||"";let d=null;function I(e){const t=document.getElementById("event-info");t.innerHTML="";const n=document.createElement("h2"),o=document.createTextNode(e.eventTitle);n.appendChild(o),t.appendChild(n);const a=document.createElement("h3"),i=document.createTextNode(`${k(e.eventDate,"longDate")} ${e.eventTime}`);a.appendChild(i),t.appendChild(a);const l=document.createElement("h3"),v=document.createTextNode(e.eventLocation);l.appendChild(v),t.appendChild(l);const m=document.createElement("h3"),B=document.createTextNode(`Number Attending: ${e.numberAttending}`);m.appendChild(B),t.appendChild(m);const h=document.createElement("p"),C=document.createTextNode(e.eventDescription);h.appendChild(C),t.appendChild(h);const p=document.createElement("section");p.setAttribute("class","form-row");const f=b("Edit Event Info","button","editButton","primary","edit_calendar");f.addEventListener("click",()=>{T.style.display="flex",c.setAttribute("aria-modal","true"),document.getElementById("eventTitle").focus(),P(c,T)}),p.appendChild(f),t.appendChild(p)}function D(e){let t=document.getElementById("eventTitle");t.value=e.eventTitle;let n=document.getElementById("eventDate"),o=e.eventDate.toDate();n.value=o.toISOString().split("T")[0];let a=document.getElementById("eventLocation");a.value=e.eventLocation;let i=document.getElementById("eventTime");i.value=e.eventTime;let l=document.getElementById("eventDescription");l.value=e.eventDescription}async function U(){if(!d){r("Cannot update event. Please try reloading the page.","main-message","error");return}let e=new FormData(c),t={eventId:s,eventTitle:"",eventDate:E.fromDate(new Date(0)),eventLocation:"",eventTime:"",eventDescription:"",numberAttending:0},n=e.get("eventTitle");if(n===null||n.toString().trim()===""){r("Please enter the title of the event","edit-event-modal-message","error");return}else t.eventTitle=n.toString();const o=e.get("eventDate");if(o===null||o===""){r("Please enter the date of the event","edit-event-modal-message","error");return}else{const m=new Date(o.toString());t.eventDate=E.fromDate(m)}let a=e.get("eventLocation");if(a===null||a.toString().trim()===""){r("Please enter the location of the event","edit-event-modal-message","error");return}else t.eventLocation=a.toString();let i=e.get("eventTime");if(i===null||i.toString().trim()===""){r("Please enter the time of the event","edit-event-modal-message","error");return}else t.eventTime=i.toString();let l=e.get("eventDescription");if(l===null||l.toString().trim()===""){r("Please enter a description for the event","edit-event-modal-message","error");return}else t.eventDescription=l.toString();const v=await x(s,t);u("edit-event-backdrop"),v?(d=t,I(t),r("The event was successfully updated","main-message","check_circle")):r("Unable to update the event. Please reload the page and try again.","main-message","error")}async function V(){if(s===""){g("Error loading event. Please try again.","main-message","error"),window.location.href="events.html";return}try{d=await S(s)}catch{g("Error loading event. Please try again.","main-message","error"),window.location.href="events.html";return}if(d===null){r("Could not find event","main-message","error"),c.remove(),M.remove(),N.remove();let e=document.createElement("section");e.setAttribute("class","card");let t=document.createElement("h2"),n=document.createTextNode("Could not find event");t.appendChild(n),e.appendChild(t);let o=document.createElement("p"),a=document.createTextNode("The event you were looking for does not exist or the url is incorrect. Please go back to the events page and try again.");o.appendChild(a),e.appendChild(o);let i=document.querySelector("main");i&&i.appendChild(e)}else D(d),I(d),F.addEventListener("click",()=>{const n=L(d,"Are you sure you want to delete this event?");if(n){const o=n.children[0],a=n.children[1];a&&a.addEventListener("click",async()=>{const i=await A(s);u("delete-item-backdrop"),i?(g(`Deleted event ${d.eventTitle} ${d.eventDate}`,"main-message","delete"),window.location.href="events.html"):r("Unable to delete event. Please reload the page and try agian.","main-message","error")}),o&&o.addEventListener("click",()=>{u("delete-item-backdrop")})}}),document.getElementById("reset").addEventListener("click",n=>{n.preventDefault(),D(d)}),document.getElementById("cancel").addEventListener("click",()=>{u("edit-event-backdrop")}),c.addEventListener("submit",n=>{n.preventDefault(),U()})}w("Upcoming Events").then(()=>{V()});
