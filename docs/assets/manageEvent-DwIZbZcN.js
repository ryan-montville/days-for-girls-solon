import{i as A,s as E,v as N,b as l,D as S,l as w,e as m,E as P,n as L,h as x,o as F,t as H,T as D,F as M,k as R,G as U}from"./app-BHFF5mJw.js";const h=document.getElementById("sign-up-entires-card"),C=document.getElementById("deleteEventCard"),$=document.getElementById("delete-button"),I=document.getElementById("edit-event-backdrop"),g=document.getElementById("edit-event-modal"),c=document.getElementById("event-info"),V=new URLSearchParams(window.location.search),b=V.get("id"),p=b||"";let s=null;function y(e){c.innerHTML="";const t=document.createElement("h2"),i=document.createTextNode(e.eventTitle);t.appendChild(i),c.appendChild(t);const o=document.createElement("h3"),n=document.createTextNode(`${L(e.eventDate,"longDate")} ${e.eventTime}`);o.appendChild(n),c.appendChild(o);const a=document.createElement("h3"),r=document.createTextNode(e.eventLocation);a.appendChild(r),c.appendChild(a);const d=document.createElement("h3"),u=document.createTextNode(`Number Attending: ${e.numberAttending}`);d.appendChild(u),c.appendChild(d);const v=document.createElement("p"),k=document.createTextNode(e.eventDescription);v.appendChild(k),c.appendChild(v);const f=document.createElement("section");f.setAttribute("class","form-row");const T=F("Edit Event Info","button","editButton","primary","edit_calendar");T.addEventListener("click",()=>{I.style.display="flex",g.setAttribute("aria-modal","true"),document.getElementById("eventTitle").focus(),H(g,I)}),f.appendChild(T),c.appendChild(f)}function B(e){let t=document.getElementById("eventTitle");t.value=e.eventTitle;let i=document.getElementById("eventDate"),o=e.eventDate.toDate();i.value=o.toISOString().split("T")[0];let n=document.getElementById("eventLocation");n.value=e.eventLocation;let a=document.getElementById("eventTime");a.value=e.eventTime;let r=document.getElementById("eventDescription");r.value=e.eventDescription}async function q(){if(l("Updating event data...","edit-event-modal-message","info"),!s){m("edit-event-backdrop"),l("Cannot update event. Please try reloading the page.","main-message","error");return}let e=new FormData(g),t={eventId:p,eventTitle:"",eventDate:D.fromDate(new Date(0)),eventLocation:"",eventTime:"",eventDescription:"",numberAttending:0},i=e.get("eventTitle");if(i===null||i.toString().trim()===""){l("Please enter the title of the event","edit-event-modal-message","error");return}else t.eventTitle=i.toString();const o=e.get("eventDate");if(o===null||o===""){l("Please enter the date of the event","edit-event-modal-message","error");return}else{const d=new Date(o.toString());t.eventDate=D.fromDate(d)}let n=e.get("eventLocation");if(n===null||n.toString().trim()===""){l("Please enter the location of the event","edit-event-modal-message","error");return}else t.eventLocation=n.toString();let a=e.get("eventTime");if(a===null||a.toString().trim()===""){l("Please enter the time of the event","edit-event-modal-message","error");return}else t.eventTime=a.toString();let r=e.get("eventDescription");if(r===null||r.toString().trim()===""){l("Please enter a description for the event","edit-event-modal-message","error");return}else t.eventDescription=r.toString();try{await M(p,t),m("edit-event-backdrop"),s=t,y(t),l("The event was successfully updated","main-message","check_circle")}catch(d){l(d,"edit-event-modal-message","error")}}function K(e,t){const n=R(e,["fullName","email","comments"],"entryId",4),a=n.querySelector("button");return a&&a.addEventListener("click",()=>{const r=w(e,"Are you sure you want to delete this entry?");if(r){const d=r.children[0],u=r.children[1];u&&u.addEventListener("click",async()=>{m("delete-item-backdrop");try{await U(e.entryId),l(`Deleted entry from ${e.fullName}`,"main-message","delete"),n.remove(),t.numberAttending-=1,y(t)}catch(v){l(v,"main-message","error")}}),d&&d.addEventListener("click",()=>{m("delete-item-backdrop")})}}),n}function _(e,t){if(t.length===0){let i=document.createElement("p"),o=document.createTextNode(`No one has signed up for ${e.eventTitle} yet`);i.appendChild(o),h.appendChild(i)}else{const i=document.getElementById("table-container");i&&i.remove();const o=document.createElement("div");o.setAttribute("id","entries-table-container"),o.setAttribute("class","table-container");const a=x("sign-up-table",["Name","Email","Comments","Delete"]);let r=t.reduce((d,u)=>{const v=K(u,e);return d.appendChild(v),d},document.createElement("tbody"));a.appendChild(r),o.appendChild(a),h.appendChild(o)}}async function z(){if(p===""){E("Error loading event. Please try again.","main-message","error"),window.location.href="events.html";return}try{s=await N(p)}catch(e){E(e,"main-message","error"),window.location.href="events.html";return}if(s===null){l("Could not find event","main-message","error"),g.remove(),h.remove(),C.remove();let e=document.createElement("section");e.setAttribute("class","card");let t=document.createElement("h2"),i=document.createTextNode("Could not find event");t.appendChild(i),e.appendChild(t);let o=document.createElement("p"),n=document.createTextNode("The event you were looking for does not exist or the url is incorrect. Please go back to the events page and try again.");o.appendChild(n),e.appendChild(o);let a=document.querySelector("main");a&&a.appendChild(e)}else{B(s);const e=await S(p);_(s,e),y(s);const t=document.getElementById("loading");t&&t.remove(),c.classList.remove("hide"),h.classList.remove("hide"),C.classList.remove("hide"),$.addEventListener("click",()=>{const n=w(s,"Are you sure you want to delete this event?");if(n){const a=n.children[0],r=n.children[1];r&&r.addEventListener("click",async()=>{m("delete-item-backdrop");try{await P(p),E(`Deleted event ${s.eventTitle} ${L(s.eventDate,"shortDate")}`,"main-message","delete"),window.location.href="events.html"}catch(d){l(d,"main-message","error")}}),a&&a.addEventListener("click",()=>{m("delete-item-backdrop")})}}),document.getElementById("reset").addEventListener("click",n=>{n.preventDefault(),B(s)}),document.getElementById("cancel").addEventListener("click",()=>{m("edit-event-backdrop")}),g.addEventListener("submit",n=>{n.preventDefault(),q()})}}A("Upcoming Events").then(()=>{z()});
